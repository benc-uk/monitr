meta {
  name: Create
  type: http
  seq: 1
}

post {
  url: {{baseUrl}}/api/monitors
  body: json
  auth: inherit
}

auth:bearer {
  token: {{process.env.TOKEN}}
}

body:json {
  {
    "name": "Test {{randomInt}}",
    "type": "http",
    "interval": "1s",
    "target": "http://localhost:8000",
    "enabled": true,
    "group": "test"
  }
}

assert {
  res.body: isDefined
  res.status: eq 200
  res.body.id: isString
}

script:pre-request {
  const { nanoid } = require('nanoid');
  bru.setVar("randomInt", nanoid())
}

script:post-response {
  bru.setVar("monitorId", res.body.id);
}
