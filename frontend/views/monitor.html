<div class="alert alert-warning" role="alert" x-show="error" x-text="error"></div>

<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="false">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-warning">
        <h1 class="modal-title fs-5" id="deleteModalLabel">Confirm Deletion</h1>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this monitor?</p>
      </div>
      <div class="modal-footer">
        <button type="button" @click="deleteMonitor" data-bs-dismiss="modal" class="btn btn-success">Sure thing!</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Yikes no!</button>
      </div>
    </div>
  </div>
</div>

<template x-if="monitor">
  <div class="card shadow mb-4">
    <div class="card-header fs-3" :class="status?.class || 'bg-secondary'" x-text="monitor.name"></div>
    <div class="card-body">
      <div class="float-end">
        <button class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#deleteModal"><i class="fas fa-trash fa-fw"></i> DELETE</button>
        <a class="btn btn-info" :href="`#edit/${monitor.id}`"><i class="fas fa-edit fa-fw"></i> EDIT</a>
      </div>
      <table class="table-responsive">
        <tbody>
          <tr>
            <td>Status:</td>
            <td x-html="`<i class='${status?.icon}'></i> ${status?.text || 'None'}`" class="fw-bold"></td>
          </tr>
          <template x-if="results[0]?.message">
            <tr>
              <td>Message:</td>
              <td x-text="results[0]?.message"></td>
            </tr>
          </template>
          <tr>
            <td style="width: 7rem">Type:</td>
            <td x-text="monitor.type"></td>
          </tr>
          <tr>
            <td>Interval:</td>
            <td x-text="monitor.interval"></td>
          </tr>
          <tr>
            <td>Enabled:</td>
            <td x-html="monitor.enabled ? `<i class='fa fa-check-circle text-success'>` : `<i class='fa fa-circle-xmark text-danger'>`"></td>
          </tr>
          <tr>
            <td>Updated:</td>
            <td x-text="updatedDate"></td>
          </tr>
          <tr>
            <td>Last Result:</td>
            <td x-text="lastResultDate || 'None'"></td>
          </tr>
        </tbody>
      </table>

      <table class="table table-sm table-hover mt-3">
        <thead class="table-primary">
          <tr>
            <th scope="col">Property</th>
            <th scope="col">Value</th>
          </tr>
        </thead>
        <tbody>
          <template x-for="val,key in monitor.properties">
            <tr>
              <td x-text="key"></td>
              <td x-text="val"></td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
  </div>
</template>

<canvas id="graph"></canvas>

<template x-if="results.length > 0">
  <div class="card shadow mt-4 mb-4">
    <div class="card-header fs-3">Last 50 results</div>
    <div class="card-body">
      <table class="table table-hover">
        <thead class="table-primary">
          <tr>
            <th scope="col">Time</th>
            <th scope="col">Status</th>
            <th scope="col">Value</th>
            <th scope="col">Message</th>
          </tr>
        </thead>
        <tbody>
          <template x-for="r in results">
            <tr>
              <td x-text="r.dateNice"></td>
              <td x-text="r.status"></td>
              <td x-text="r.value"></td>
              <td x-text="r.message"></td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
  </div>
</template>
